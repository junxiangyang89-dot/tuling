<div class="assignment-review-container">
  <!-- å¤´éƒ¨å¯¼èˆª -->
  <header class="header">
    <div class="logo-section">
      <h1>å›¾çµæœºæ¨¡æ‹Ÿå™¨ - æ•™å¸ˆæ¨¡å¼</h1>
      <p class="subtitle">ä¼˜ç§€ä½œä¸šå®¡æ ¸ç³»ç»Ÿ</p>
    </div>
    <div class="user-section">
      <span class="username">{{ currentUsername || 'æ•™å¸ˆ' }}</span>
      <button class="welcome-btn" (click)="navigateToWelcome()">è¿”å›æ¬¢è¿é¡µ</button>
      <button class="logout-btn" (click)="logout()">é€€å‡ºç™»å½•</button>
    </div>
  </header>

  <!-- ä¸»å†…å®¹åŒº -->
  <main class="main-content">
    <div class="sidebar">
      <h2>å¾…å®¡æ ¸ä¼˜ç§€ä½œä¸š</h2>
      
      <!-- åˆ·æ–°æŒ‰é’® -->
      <button class="refresh-btn" (click)="loadPendingAssignments()" [disabled]="isLoading">
        <span *ngIf="!isLoading">ğŸ”„ åˆ·æ–°åˆ—è¡¨</span>
        <span *ngIf="isLoading">â³ åŠ è½½ä¸­...</span>
      </button>

      <!-- ä½œä¸šåˆ—è¡¨ -->
      <div class="assignment-list">
        <div *ngIf="isLoading" class="loading-message">
          æ­£åœ¨åŠ è½½å¾…å®¡æ ¸ä½œä¸š...
        </div>
        
        <div *ngIf="!isLoading && errorMessage" class="error-message">
          {{ errorMessage }}
        </div>
        
        <div *ngIf="!isLoading && pendingAssignments.length === 0" class="empty-message">
          æš‚æ— å¾…å®¡æ ¸çš„ä¼˜ç§€ä½œä¸š
        </div>
        
        <div 
          *ngFor="let assignment of pendingAssignments" 
          class="assignment-item"
          [class.selected]="selectedAssignment && selectedAssignment.id === assignment.id"
          (click)="viewAssignmentDetails(assignment)"
        >
          <h3 class="assignment-title">{{ assignment.title }}</h3>
          <div class="assignment-meta">
            <span class="creator">æäº¤è€…: {{ assignment.creatorUsername || 'æœªçŸ¥ç”¨æˆ·' }}</span>
            <span class="date">{{ assignment.createTime | date: 'yyyy-MM-dd HH:mm' }}</span>
          </div>
          <div class="assignment-status">
            <span class="status-pending">å¾…å®¡æ ¸</span>
          </div>
        </div>
      </div>
    </div>

    <!-- è¯¦æƒ…é¢æ¿ -->
    <div class="details-panel" *ngIf="selectedAssignment">
      <div class="details-header">
        <h2>ä½œä¸šè¯¦æƒ…</h2>
        <button class="close-btn" (click)="closeDetails()">âœ•</button>
      </div>
      
      <div class="details-content">
        <div class="detail-section">
          <h3>{{ selectedAssignment.title }}</h3>
          <div class="detail-meta">
            <p><strong>æäº¤è€…:</strong> {{ selectedAssignment.creatorUsername || 'æœªçŸ¥ç”¨æˆ·' }}</p>
            <p><strong>æäº¤æ—¶é—´:</strong> {{ selectedAssignment.createTime | date: 'yyyy-MM-dd HH:mm:ss' }}</p>
            <p><strong>çŠ¶æ€:</strong> 
              <span class="status-pending">{{ selectedAssignment.status || 'PENDING' }}</span>
            </p>
          </div>
        </div>

        <div class="detail-section">
          <h4>é¢˜ç›®æè¿°</h4>
          <p class="description">{{ selectedAssignment.description || 'æš‚æ— æè¿°' }}</p>
        </div>

        <div class="detail-section">
          <h4>æµ‹è¯•ç”¨ä¾‹</h4>
          <pre class="testcase-data" *ngIf="selectedAssignment.testcaseJson">{{ formatTestcaseJson(selectedAssignment.testcaseJson) }}</pre>
          <p class="no-data" *ngIf="!selectedAssignment.testcaseJson">æš‚æ— æµ‹è¯•ç”¨ä¾‹æ•°æ®</p>
        </div>

        <div class="action-buttons">
          <button class="approve-btn" (click)="approveAssignment(selectedAssignment.id)">
            âœ… å®¡æ‰¹é€šè¿‡
          </button>
          <button class="reject-btn" (click)="rejectAssignment(selectedAssignment.id)">
            âŒ æ‹’ç»
          </button>
        </div>
      </div>
    </div>

    <!-- æ— é€‰æ‹©ä½œä¸šæ—¶çš„æç¤º -->
    <div class="no-selection" *ngIf="!selectedAssignment && pendingAssignments.length > 0">
      <p>è¯·ä»å·¦ä¾§åˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªå¾…å®¡æ ¸çš„ä¼˜ç§€ä½œä¸š</p>
    </div>
  </main>

  <!-- Toast æç¤º -->
  <app-shared-toast></app-shared-toast>
</div>
